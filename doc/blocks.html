<html>
<title>PALM -- Definition of blocks</title>
<body>
<h2>Freely exchangeable data</h2>

<p>For designs in which the data can be shuffled freely, there is no need to specify exchangeability blocks, and all observations are implicitly be assigned to the same large block. This also implies that the data is homoscedastic, i.e., same variance for all observations, and as a consequence, there is just one variance group for all data. The statistic that is computed is either <i>t</i> or <i>F</i>, depending on the kind of contrast.</p>

<hr>

<h2>Data exchangeable within block</h2>

<p>If there are restrictions on exchangeability, blocks of data can be defined such that shuffling happens within block only. The exchangeability blocks file contains a single column vector with integer indices, each specifying a block. This file is supplied with the option <code>-eb</code>. An example is:</p>

<code>
1<br>
1<br>
1<br>
1<br>
2<br>
2<br>
2<br>
</code>

<p>Permutations happen only between the observations that share the same index, i.e., within block only. For this kind of permutation, the blocks are not required to be of the same size. Moreover, it is no longer necessary to assume homoscedasticity, and each block is, by default, considered a variance group (<span style="font-variant: small-caps;">vg</span>). Variances are estimated for each block, and statistics that are robust to heteroscedasticity are computed. Instead of <i>t</i>, the Aspin-Welch <i>v</i> is calculated, and instead of <i>F</i>, the <i>G</i> statistic, which is a generalisation of all these common statistics. For the example above, the default variance groups are:</p>

<code>
1<br>
1<br>
1<br>
1<br>
2<br>
2<br>
2<br>
</code>

<p>However, if the user wants to assume homoscedasticity or in any way group the observations differently based on other variance assumptions, irrespectively to the specification of exchangeability blocks, a file with variance groups indices can be supplied with the option <code>-vg</code>. The file format for the variance groups is always column vector with integer indices, similar as the example above for the exchangeability blocks file.</p>

<hr>

<h2>Blocks of data exchangeable as a whole</h2>

<p>If there are restrictions on exchangeability, and if instead of shuffling within block, the blocks as a whole can be shuffled while keeping the observations inside the block in the same order, the exchangeability blocks file is supplied with the option <code>-eb</code>, exactly as above, and the flag <code>-sb</code> (shuffle blocks) is supplied. An example of such file is:</p>

<code>
1<br>
1<br>
1<br>
2<br>
2<br>
2<br>
</code>

<p>Permutations and/or sign-flips, as applicable, will rearrange the blocks as a whole, not each observation individually. All blocks must be of the same size, and by default, the variance groups are defined such that the first group includes all the first observations in each block, the second group all the second observations in each block, and so on. For the example above, the default variance groups are:</p>

<code>
1<br>
2<br>
3<br>
1<br>
2<br>
3<br>
</code>

<p>Variances are estimated within group, and statistics that are robust to heteroscedasticity are computed, i.e., instead of <i>t</i>, <i>v</i> is calculated, and instead of <i>F</i>, the <i>G</i> statistic is calculated.</p>

<p>As in the within block case, the default variance groups definition can be overridden with the specification of a variance groups file, with the option <code>-vg</code>.</p>

<hr>

<h2>Complex dependence between data</h2>

<p>It is possible to have multiple levels of complexity, each encompassing within-block and whole-block shuffling, which are then nested into each other. This can be done by supplying an exchangeability blocks file not with one, but with multiple columns. Each column indicates a deeper level of dependence. Indices on one level indicate how the unique sub-indices of the next level should be shuffled:</p>
<ul>
<li>Positive indices at a given level indicate that the sub-indices of the next level should be shuffled as a whole, akin to whole-block shuffling with the -sb option described above.</li>
<li>Negative indices at given level indicate that the corresponding sub-indices in the next level should remain fixed and their own sub-sub-indices should be shuffled, akin to within block permutation described above.</li>
</ul>
<p>With this more complex structure, the option <code>-sb</code>, even if supplied, is ignored, as this information is embedded, at multiple levels, in the file with the block definitions. In fact, even in the simpler cases of no blocks, within and whole block permutation, discussed above, can be fully specified using a multi-column exchangeability blocks file, regardless of the <code>-sb</code> option.</p>

<p><i>Example 1:</i> Freely exchangeable data. This is equivalent to having all observations in a single block, with no restrictions.</p>

<code>
1 1<br>
1 2<br>
1 3<br>
1 4<br>
1 5<br>
1 6<br>
</code>

<p>The 1st column indicates that all indices in the next level (1,...,6) can be shuffled with each other. This also implies a single large variance group that encompasses all observations.</p>

<p><i>Example 2:</i> Three blocks of data that are exchangeable within block only.</p>

<code>
-1 1<br>
-1 1<br>
-1 2<br>
-1 2<br>
-1 3<br>
-1 3<br>
</code>

<p>The negative indices in the 1st column indicate that the sub-indices in the next column cannot be shuffled. The indices for each individual observation here were omitted, but could equivalently have been specified as:</p>

<code>
-1 1 1<br>
-1 1 2<br>
-1 2 1<br>
-1 2 2<br>
-1 3 1<br>
-1 3 2<br>
</code>

<p> The default <span style="font-variant: small-caps;">vg</span> look like this</p>

<code>
1<br>
1<br>
2<br>
2<br>
3<br>
3<br>
</code>

<p>The positive indices in the 2nd column indicate that the respective sub-indices in the next column can be shuffled.</p>

<p><i>Example 3:</i> Three blocks of data that are exchangeable as a whole.</p>

<code>
1 1<br>
1 1<br>
1 2<br>
1 2<br>
1 3<br>
1 3<br>
</code>

<p>The positive index in the 1st column indicates that the respective sub-indices in the next column (level) are exchangeable as a whole. The same could equivalently have been specified as:</p>

<code>
1 -1 1<br>
1 -1 2<br>
1 -2 1<br>
1 -2 2<br>
1 -3 1<br>
1 -3 2<br>
</code>

<p>The 1st column indicates that the sub-indices in the next level (2nd column) are exchangeable as a whole. The negative indices in the 2nd level indicate that each respective sub-index, now in the 3rd column is exchangeable with each other, i.e., within the blocks specified in the previous level.</p>

<p> The default <span style="font-variant: small-caps;">vg</span> look like this</p>

<code>
1<br>
2<br>
1<br>
2<br>
1<br>
2<br>
</code>

<p>These very same basic rules apply to hierarchies of blocks that can become very complicated.</p>
<hr>
</body>
</html>